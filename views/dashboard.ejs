<% include ./partials/top-bar %>

<div class="container-fluid">
  <div class="row">
    <% include ./partials/side-bar %>

    <!-- content area -->
    <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-4">
      <h2>Dashboard</h2>
      <div class="content">
        <% include ./partials/messages %> <% if(user.admin == true) { %>
        <p><strong>Total Orders:</strong> <%= totalOrders %></p>
        <table class="table">
          <thead>
            <tr>
              <th>Invoice Number</th>
              <th>User Name</th>
              <th>Total Amount</th>
              <th>Payment Choice</th>
            </tr>
          </thead>
          <tbody>
            <% allOrders.forEach(order => { %>
            <tr>
              <td>#<%= order.invNumb %></td>
              <td><%= order.userName %></td>
              <td>N<%= order.totalAmount %></td>
              <td><%= order.paymentChoice %></td>
            </tr>
            <% }) %>
          </tbody>
        </table>

        <% let totalSales = allOrders.reduce((total, val) => total +
        val.totalAmount, 0) %>

        <p><strong>Total Sales:</strong> N<%= totalSales %></p>

        <p><strong>Total Products:</strong> <%= totalProducts %></p>

        <% } %> <% if(user.admin == false) { %>

        <h4>My Orders</h4>
        <table class="table">
          <thead>
            <tr>
              <th>Invoice Number</th>
              <th>Total Amount</th>
            </tr>
          </thead>
          <tbody>
            <% singleOrders.forEach(order => { %>
            <tr>
              <td>#<%= order.invNumb %></td>
              <td>N<%= order.totalAmount %></td>
            </tr>
            <% }) %>
          </tbody>
        </table>

        <% } %>
      </div>
    </main>
    <!-- end of content area -->
  </div>
</div>
